<!doctype html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Load jQuery -->

  <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>

  <!-- Load Swiper stuff -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.0/css/swiper.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.0/js/swiper.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/3.4.0/js/swiper.jquery.min.js"></script>

  <!-- Load c3.css -->
  <link href="c3/c3.min.css" rel="stylesheet" type="text/css">

  <!-- Load d3.js and c3.js -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>
  <script src="https://d3js.org/d3-axis.v1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.js"></script>
  <script src="c3/c3.min.js"></script>
  <link href="https://fonts.googleapis.com/css?family=Merriweather+Sans" rel="stylesheet">


  <style>
    body,html{
      overflow: hidden;
      font-family: 'Merriweather Sans';
    }
    .content{
      position: absolute;
      top:0px;
      left:0px;
      width: 100%;
      height:100%;
    }
    .chartSkinny{
      max-width: 720px;
      /*width:100%;*/
      margin:0 auto;
      position: absolute;
      top:240px;
      /*left:0px;*/
      bottom:48px;
      background-color: #ffffff;
    }
    .c3-line, .c3-target.c3-focused path.c3-line, .c3-target.c3-focused path.c3-step{
      stroke-width: 4px;
    }
    .c3-legend-background{
      opacity: 0;
    }
    .swiper-container{
      position:absolute;
      z-index: 100;
      background: none;
      height:100%;
      width: 100%;
      top:0px;
      left:0px;
      /*height:300px;*/
    }
    @media(min-width:992px){
      .swiper-container,.swiper-slide{
        pointer-events: none;
      }
      .msgMob{
        display: none;
      }

    }
    @media(max-width:991px){
      .msgDesk{
        display: none;
      }
    }
    .button{
      position: fixed;
      bottom:0px;
      height: 48px;
      background-color: #cccccc;
      width: 50%;
      text-align: center;
      z-index: 900;
    }
    .buttonUp{
      left:0px;
    }
    .buttonDown{
      right:0px;
    }
    .card{
      line-height: 1.7;
      max-width: 720px;
      margin: 0 auto;
      text-align: center;
      padding-top: 12px;
    }
    .highlight {
      border-bottom: thick solid;
      padding:2px;
    }
    .hi1{
      border-bottom-color: #FF1E54;
    }
    .hi2{
      border-bottom-color: #007AFF;
    }
    .hi3{
      border-bottom-color: #84FF00;
    }
    .hi5{
      border-bottom-color: #FFD80D;
    }
    .fullSlide{
      background-color: #ffffff;
      height: 100%;
      /*padding-bottom: 48px;*/
    }
    #otherStates{
      top:12px;
      max-width: 720px;
      max-height: 400px;
      padding-bottom: 48px;
      margin: 0 auto;
    }
    svg {
      pointer-events: auto;
    }
    p {
      padding-left: 6px; padding-right: 6px;
    }
    .cardLeft{
      text-align: left;
      height:100%;
      background-color: #ffffff;
      pointer-events: all;
      display: table;
    }
    .clWrap{
      display: table-cell;
      vertical-align: middle;
    }
    /*['FF1E54','007AFF','84FF00','FF5D00','FFD80D','rgb(140, 86, 75)']*/
  </style>

</head>
<html>

  <div class="swiper-container">
    <!-- Additional required wrapper -->
    <div class="swiper-wrapper">
        <!-- Slides -->
        <div class="swiper-slide fullSlide">
          <div class="card">
            <h1>Early voting increased for everyone but Black voters in N.C.</h1>
            <p>In a state where one-stop early voting became the favorite method for many, a divide emerged along racial lines. </p>
            <p><span class="msgMob">Swipe</span><span class="msgDesk">Scroll down</span> or hit "NEXT" to begin.</p>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="card">
            <p>2016 saw a surge in early voting for most of North Carolina's voting population. According to the state's elections board's data on "one-stop," in-person, early voting, 10 percent more early ballots came from <span class="highlight hi1">white</span> voters than in 2012 ...</p>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="card">
            <p>and <span class="highlight hi2">Asian</span> early voters surged dramatically,</p>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="card">
            <p>as did <span class="highlight hi3">Native Americans</span> ...</p>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="card">
            <p>and other racial minorities, except for</p>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="card">
            <p><span class="highlight hi5">Black</span> early voters, who dropped sharply. No other measured racial group turned out fewer early voters than four years ago.</p>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="card">
            <p>The total vote count for 2016 shows the size of the disparity. Nearly <span class="highlight hi5">80,000 fewer Black people</span> in North Carolina voted early than in 2012, while the state as a whole saw an increase. At the same time, early turnout was nearly <span class="highlight hi1">195,000 higher among white voters</span>.</p>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="card">
            <p>The drop was across the board. Eighty-one of 100 counties saw Black early voting turnout fall. (Graham County, which increased from 0 to 1 Black voter, is not shown.)</p>
          </div>
        </div>
        <div class="swiper-slide fullSlide">
          <div class="card">
            <p>According to Michael McDonald, a University of Florida professor who runs an elections data service, North Carolina stands out. He <a href="https://twitter.com/ElectProject/status/795378059570544645">found</a> that in other southern states collecting data on the race of early voters, Black turnout remained steady.</p>
          </div>
          <div id = "otherStates">xx</div>
        </div>
        <div class="swiper-slide">
          <div class="card cardLeft">
            <div class="clWrap">
              <p>Part of the drop in the Black share of early voters may be explained by cuts to early polling places. HB 589, the law overturned by a federal court for what it called a "surgical" targeting of Black voters, would have allowed counties to cut the first week of early voting. Without the law in place, each county was required to maintain at least one open location for that week.</p>
              <p>Seventeen counties then closed all but the one required location for the first seven days. The blog Insightus found turnout in those counties <a href="http://www.insight-us.org/blog/super-suppressors-the-17-north-carolina-counties-that-are-strangling-early-voting-to-death/">initially trailed</a>&nbsp;the rest of the state dramatically.</p>
            </div>
          </div>
        </div>
        <div class="swiper-slide">
          <div class="card cardLeft">
            <p>When the early voting period concluded, a press release from the North Carolina Republican party <a href="http://us2.campaign-archive2.com/?u=f3100bc5464cbba2f472ddf2c&amp;id=e4b9a8fb19">noted</a>&nbsp;the drop in Black&nbsp;turnout as an "encouraging" trend.</p>
          </div>
        </div>

    </div>
    <div class="swiper-pagination swiper-pagination1"></div>
  </div>


  <div class="content">
    <div id="c3Line" class="chartStyle chartSkinny"></div>
    <div id="c3Bar" class="chartStyle chartSkinny" style="display:none"></div>
  </div>
  <div class="button buttonUp">
    BACK
  </div>
  <div class="button buttonDown">
    NEXT
  </div>

  <script>
    var chartEarly;
    var chartCounty;
    var formatter;
    var formatterThousands = d3.format("+,");
    function formatterPct(d,fType) {
      if (fType=='pct') {
        if (d>=0) {
          return "+"+d + '%';
        }
        else {
          return d + '%';
        }
      }
      else {
        return formatterThousands(d);
      }
    }


    function slideIt(dir,n) {
      switch (n) {
        case 1:
          if (dir=='prev') {
            chartEarly.load({
              unload: ['ASIAN','INDIAN AMERICAN or ALASKA NATIVE','TWO or MORE RACES','BLACK or AFRICAN AMERICAN','OTHER / UNDESIGNATED']
            });
          }
          else {
            fType='pct';
            chartEarly = c3.generate({
              bindto: '#c3Line',
              data: { // PERCENTAGE CHANGE IN TOTAL ONE-STOP EARLY VOTES, 2012-2016
                columns: [
                  ['WHITE', 0, 10.40]
                ],
                labels:false
              },
              color : {
                pattern: ['FF1E54','007AFF','84FF00','FF5D00','FFD80D','rgb(140, 86, 75)']
              },
              grid: {
                  y: {
                      lines: [{value: 0}]
                  }
              },
              tooltip: {
                  grouped: false // Default true
              },
              axis: {
                x: {
                  type: 'category',
                  categories: ['2012 early voting', '2016 early voting']
                },
                y : {
                  tick : {
                    format: function(d){
                      return formatterPct(d,fType);
                    }
                  }
                }
              },
              legend:{
                position: 'inset'
              },
              point: {
                r: 3
              },
              transition:{
                duration: 1000
              },
              oninit: function () {   // From jsfiddle by Masayuki Tanaka
                this.main.append('rect')
                    .style('fill', 'white')
                    .attr('x', 0.5)
                    .attr('y', -0.5)
                    .attr('width', this.width)
                    .attr('height', this.height)
                  .transition().duration(1000)
                    .attr('x', this.width)
                    .attr('width', 0)
                  .remove();
            }
            });
          }


        break;
        case 2:
          if (dir=='prev') {
            chartEarly.load({
              unload: ['INDIAN AMERICAN or ALASKA NATIVE','TWO or MORE RACES','BLACK or AFRICAN AMERICAN','OTHER / UNDESIGNATED']
            });
          }
          else{
            chartEarly.load({
              columns: [
                ['WHITE', 0, 10.40],
                ['ASIAN', 0, 47.60]
              ]
            });
          }
        break;
        case 3:
          if (dir=='prev') {
            chartEarly.load({
              unload: ['TWO or MORE RACES','BLACK or AFRICAN AMERICAN','OTHER / UNDESIGNATED']
            });
          }
          else {
            chartEarly.load({
              columns: [
                ['WHITE', 0, 10.40],
                ['ASIAN', 0, 47.60],
                ['INDIAN AMERICAN or ALASKA NATIVE', 0, 16.02]
              ]
            });
          }
        break;
        case 4:
          if (dir=='prev') {
            chartEarly.load({
              unload: ['BLACK or AFRICAN AMERICAN','OTHER / UNDESIGNATED']
            });
          }
          else {
            chartEarly.load({
              columns: [
                ['WHITE', 0, 10.40],
                ['ASIAN', 0, 47.60],
                ['INDIAN AMERICAN or ALASKA NATIVE', 0, 16.02],
                ['TWO or MORE RACES', 0, 17.65]
              ]
            });
          }

        break;
        case 5:
          if (dir=='prev'){
            chartEarly.load({
              unload: ['OTHER / UNDESIGNATED']
            });
            $(".c3-target-OTHER---UNDESIGNATED").hide();

          }

          chartEarly.load({
            columns: [
              ['WHITE', 0, 10.40],
              ['ASIAN', 0, 47.60],
              ['INDIAN AMERICAN or ALASKA NATIVE', 0, 16.02],
              ['TWO or MORE RACES', 0, 17.65],
              ['BLACK or AFRICAN AMERICAN', 0, -10.46]
            ]
          });

        break;
        case 6:
          if (dir=='prev') {
            $("#c3Bar").fadeOut(300,function(){
              $("#c3Line").fadeIn(300);
            });
            chartEarly.flush();
          }
          fType='int';
          $(".c3-target-OTHER---UNDESIGNATED").show();
          chartEarly.load({
            columns: [
              ['WHITE', 0, 194604],
              ['ASIAN', 0, 10610],
              ['INDIAN AMERICAN or ALASKA NATIVE', 0, 1853],
              ['TWO or MORE RACES', 0, 2451],
              ['BLACK or AFRICAN AMERICAN', 0, -79248],
              ['OTHER / UNDESIGNATED', 0, 49629]
            ]
          });
          // chartEarly.flush();
        break;
        case 7:
          $("#c3Line").fadeOut(300,function() {
            $("#c3Bar").fadeIn(300, function(){
              chartCounty = c3.generate({
                bindto: '#c3Bar',
                data: { // COUNTY COUNTY COUNTY
                  columns: [
                    ["ALAMANCE",-0.0527098831],
                    ["ALEXANDER",-0.113345521],
                    ["ALLEGHANY",0.02040816327],
                    ["ANSON",-0.227478076],
                    ["ASHE",0.07894736842],
                    ["AVERY",0],
                    ["BEAUFORT",-0.1721773206],
                    ["BERTIE",-0.1867080424],
                    ["BLADEN",-0.2528187337],
                    ["BRUNSWICK",-0.1683070866],
                    ["BUNCOMBE",-0.1090747331],
                    ["BURKE",-0.08981380066],
                    ["CABARRUS",0.05434662543],
                    ["CALDWELL",-0.2638398115],
                    ["CAMDEN",-0.115530303],
                    ["CARTERET",0.01379310345],
                    ["CASWELL",0.01205727204],
                    ["CATAWBA",-0.1787317073],
                    ["CHATHAM",-0.05062325108],
                    ["CHEROKEE",0.05084745763],
                    ["CHOWAN",-0.1992903607],
                    ["CLAY",-0.25],
                    ["CLEVELAND",-0.07766323024],
                    ["COLUMBUS",-0.2602912098],
                    ["CRAVEN",-0.117085863],
                    ["CUMBERLAND",-0.1063447632],
                    ["CURRITUCK",0.02058823529],
                    ["DARE",-0.04149377593],
                    ["DAVIDSON",-0.1608796296],
                    ["DAVIE",-0.09343936382],
                    ["DUPLIN",-0.117083947],
                    ["DURHAM",-0.02475775721],
                    ["EDGECOMBE",-0.1321434288],
                    ["FORSYTH",-0.1410632176],
                    ["FRANKLIN",-0.03059689015],
                    ["GASTON",-0.07829476653],
                    ["GATES",-0.1048321048],
                    ["GRANVILLE",-0.1126340073],
                    ["GREENE",-0.187250996],
                    ["GUILFORD",-0.07090232359],
                    ["HALIFAX",-0.2071709135],
                    ["HARNETT",-0.06454518163],
                    ["HAYWOOD",0.05025125628],
                    ["HENDERSON",0.03378378378],
                    ["HERTFORD",-0.1445600347],
                    ["HOKE",-0.04444057163],
                    ["HYDE",-0.05555555556],
                    ["IREDELL",-0.152931181],
                    ["JACKSON",0.7416267943],
                    ["JOHNSTON",0.003883710608],
                    ["JONES",-0.1756046267],
                    ["LEE",-0.1473684211],
                    ["LENOIR",-0.1312798363],
                    ["LINCOLN",-0.1163675911],
                    ["MACON",-0.2926829268],
                    ["MADISON",1],
                    ["MARTIN",-0.1524585394],
                    ["MCDOWELL",0.04427083333],
                    ["MECKLENBURG",-0.09832828144],
                    ["MITCHELL",0.1666666667],
                    ["MONTGOMERY",0.07107023411],
                    ["MOORE",-0.2146151979],
                    ["NASH",-0.04356665699],
                    ["NEW HANOVER",-0.2348544799],
                    ["NORTHAMPTON",-0.2385972954],
                    ["ONSLOW",-0.1103651987],
                    ["ORANGE",-0.1169105048],
                    ["PAMLICO",-0.2100098135],
                    ["PASQUOTANK",-0.2202178961],
                    ["PENDER",-0.1445988092],
                    ["PERQUIMANS",-0.1558685446],
                    ["PERSON",-0.07624493686],
                    ["PITT",-0.06426480075],
                    ["POLK",-0.2511737089],
                    ["RANDOLPH",0.02467035304],
                    ["RICHMOND",-0.12181941],
                    ["ROBESON",-0.2608252097],
                    ["ROCKINGHAM",-0.07436366661],
                    ["ROWAN",-0.198480283],
                    ["RUTHERFORD",-0.2119258662],
                    ["SAMPSON",-0.1549904861],
                    ["SCOTLAND",-0.1572470374],
                    ["STANLY",-0.1264044944],
                    ["STOKES",-0.07911392405],
                    ["SURRY",-0.1061093248],
                    ["SWAIN",-0.625],
                    ["TRANSYLVANIA",-0.2565320665],
                    ["TYRRELL",-0.1797752809],
                    ["UNION",-0.0786622213],
                    ["VANCE",-0.1031291854],
                    ["WAKE",-0.08435387479],
                    ["WARREN",-0.110982659],
                    ["WASHINGTON",-0.1605215827],
                    ["WATAUGA",0.1734417344],
                    ["WAYNE",-0.1519576265],
                    ["WILKES",-0.1903073286],
                    ["WILSON",-0.144295302],
                    ["YADKIN",0.07142857143],
                    ["YANCEY",-0.02857142857]
                  ],
                  // [
                  //   ["MADISON",1],
                  //   ["JACKSON",0.7416267943],
                  //   ["WATAUGA",0.1734417344],
                  //   ["MITCHELL",0.1666666667],
                  //   ["ASHE",0.07894736842],
                  //   ["YADKIN",0.07142857143],
                  //   ["MONTGOMERY",0.07107023411],
                  //   ["CABARRUS",0.05434662543],
                  //   ["CHEROKEE",0.05084745763],
                  //   ["HAYWOOD",0.05025125628],
                  //   ["MCDOWELL",0.04427083333],
                  //   ["HENDERSON",0.03378378378],
                  //   ["RANDOLPH",0.02467035304],
                  //   ["CURRITUCK",0.02058823529],
                  //   ["ALLEGHANY",0.02040816327],
                  //   ["CARTERET",0.01379310345],
                  //   ["CASWELL",0.01205727204],
                  //   ["JOHNSTON",0.003883710608],
                  //   ["AVERY",0],
                  //   ["DURHAM",-0.02475775721],
                  //   ["YANCEY",-0.02857142857],
                  //   ["FRANKLIN",-0.03059689015],
                  //   ["DARE",-0.04149377593],
                  //   ["NASH",-0.04356665699],
                  //   ["HOKE",-0.04444057163],
                  //   ["CHATHAM",-0.05062325108],
                  //   ["ALAMANCE",-0.0527098831],
                  //   ["HYDE",-0.05555555556],
                  //   ["PITT",-0.06426480075],
                  //   ["HARNETT",-0.06454518163],
                  //   ["GUILFORD",-0.07090232359],
                  //   ["ROCKINGHAM",-0.07436366661],
                  //   ["PERSON",-0.07624493686],
                  //   ["CLEVELAND",-0.07766323024],
                  //   ["GASTON",-0.07829476653],
                  //   ["UNION",-0.0786622213],
                  //   ["STOKES",-0.07911392405],
                  //   ["WAKE",-0.08435387479],
                  //   ["BURKE",-0.08981380066],
                  //   ["DAVIE",-0.09343936382],
                  //   ["MECKLENBURG",-0.09832828144],
                  //   ["VANCE",-0.1031291854],
                  //   ["Grand Total",-0.1046279047],
                  //   ["GATES",-0.1048321048],
                  //   ["SURRY",-0.1061093248],
                  //   ["CUMBERLAND",-0.1063447632],
                  //   ["BUNCOMBE",-0.1090747331],
                  //   ["ONSLOW",-0.1103651987],
                  //   ["WARREN",-0.110982659],
                  //   ["GRANVILLE",-0.1126340073],
                  //   ["ALEXANDER",-0.113345521],
                  //   ["CAMDEN",-0.115530303],
                  //   ["LINCOLN",-0.1163675911],
                  //   ["ORANGE",-0.1169105048],
                  //   ["DUPLIN",-0.117083947],
                  //   ["CRAVEN",-0.117085863],
                  //   ["RICHMOND",-0.12181941],
                  //   ["STANLY",-0.1264044944],
                  //   ["LENOIR",-0.1312798363],
                  //   ["EDGECOMBE",-0.1321434288],
                  //   ["FORSYTH",-0.1410632176],
                  //   ["WILSON",-0.144295302],
                  //   ["HERTFORD",-0.1445600347],
                  //   ["PENDER",-0.1445988092],
                  //   ["LEE",-0.1473684211],
                  //   ["WAYNE",-0.1519576265],
                  //   ["MARTIN",-0.1524585394],
                  //   ["IREDELL",-0.152931181],
                  //   ["SAMPSON",-0.1549904861],
                  //   ["PERQUIMANS",-0.1558685446],
                  //   ["SCOTLAND",-0.1572470374],
                  //   ["WASHINGTON",-0.1605215827],
                  //   ["DAVIDSON",-0.1608796296],
                  //   ["BRUNSWICK",-0.1683070866],
                  //   ["BEAUFORT",-0.1721773206],
                  //   ["JONES",-0.1756046267],
                  //   ["CATAWBA",-0.1787317073],
                  //   ["TYRRELL",-0.1797752809],
                  //   ["BERTIE",-0.1867080424],
                  //   ["GREENE",-0.187250996],
                  //   ["WILKES",-0.1903073286],
                  //   ["ROWAN",-0.198480283],
                  //   ["CHOWAN",-0.1992903607],
                  //   ["HALIFAX",-0.2071709135],
                  //   ["PAMLICO",-0.2100098135],
                  //   ["RUTHERFORD",-0.2119258662],
                  //   ["MOORE",-0.2146151979],
                  //   ["PASQUOTANK",-0.2202178961],
                  //   ["ANSON",-0.227478076],
                  //   ["NEW HANOVER",-0.2348544799],
                  //   ["NORTHAMPTON",-0.2385972954],
                  //   ["CLAY",-0.25],
                  //   ["POLK",-0.2511737089],
                  //   ["BLADEN",-0.2528187337],
                  //   ["TRANSYLVANIA",-0.2565320665],
                  //   ["COLUMBUS",-0.2602912098],
                  //   ["ROBESON",-0.2608252097],
                  //   ["CALDWELL",-0.2638398115],
                  //   ["MACON",-0.2926829268],
                  //   ["SWAIN",-0.625]
                  // ],
                  type: 'bar',
                  labels:false
                },
                bar: {
                  width: {
                      ratio: 0.99 // this makes bar width 50% of length between ticks
                  }
                  // or
                  //width: 100 // this makes bar width 100px
                },
                color : {
                  pattern: ['FF1E54']
                },
                grid: {
                    y: {
                        lines: [{value: 0}]
                    }
                },
                tooltip: {
                    grouped: false // Default true
                },
                axis: {
                  x: {
                    type: 'category',
                    categories: ['% change, 2012 - 2016 Black one-stop early voting by county']
                  },
                  y : {
                    tick : {
                      format: d3.format("+.0%")
                    }
                  }
                },
                legend:{
                  show: false
                },
                point: {
                  r: 3
                },
                transition:{
                  duration: 1000
                },
                oninit: function () {   // From jsfiddle by Masayuki Tanaka
                  this.main.append('rect')
                      .style('fill', 'white')
                      .attr('x', 0.5)
                      .attr('y', -0.5)
                      .attr('width', this.width)
                      .attr('height', this.height)
                    .transition().duration(1000)
                      .attr('x', this.width)
                      .attr('width', 0)
                    .remove();
              }
              });
            })
          });


        break;

        default:

      }
      }

      $("document").ready(function(){
        var states = c3.generate({
          bindto: '#otherStates',
          data: { // COUNTY COUNTY COUNTY
            columns: [
              ["Florida",.023],
              ["Georgia",.037],
              ["Louisiana",.185],
              ["North Carolina",-.087]
            ],
            type: 'bar',
            labels:false
          },
          bar: {
            width: {
                ratio: 0.99 // this makes bar width 50% of length between ticks
            }
            // or
            //width: 100 // this makes bar width 100px
          },
          color : {
            pattern: [d3.rgb('#FF1E54').darker(2),'FF1E54',d3.rgb('#FF1E54').darker(-2),'FFD80D','rgb(140, 86, 75)']
          },
          tooltip: {
              grouped: false, // Default true
              format: {
                value: d3.format("+.1%")
              }
          },
          axis: {
            x: {
              type: 'category',
              categories: ['% change, 2012 - 2016 Black early voting by state']
            },
            y : {
              tick : {
                format: d3.format("+.0%")
              }
            }
          },
          legend:{
            show: true,
            position: 'right'
          },
          point: {
            r: 3
          },
          transition:{
            duration: 1000
          }
        });
      })

  </script>

  <script src="swiper.js"></script>

</html>
